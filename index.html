<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AirCalc ‚Äî –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –º–æ—â–Ω–æ—Å—Ç–∏ –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä–∞ –æ–Ω–ª–∞–π–Ω</title>
    <meta name="description" content="–ë—ã—Å—Ç—Ä—ã–π —Ä–∞—Å—á–µ—Ç –º–æ—â–Ω–æ—Å—Ç–∏ –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä–∞ –¥–ª—è –∫–≤–∞—Ä—Ç–∏—Ä—ã –∏ –æ—Ñ–∏—Å–∞. –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –Ω—É–∂–Ω—É—é –º–æ–¥–µ–ª—å –ø–æ –ø–ª–æ—â–∞–¥–∏ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º –ø–æ–º–µ—â–µ–Ω–∏—è –∑–∞ 2 –º–∏–Ω—É—Ç—ã.">
    <meta name="theme-color" content="#0EA5E9">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #0EA5E9;
            --secondary: #06B6D4;
            --accent: #14B8A6;
            --success: #10B981;
            --warning: #F59E0B;
            --bg-primary: #E0F2FE;
            --bg-secondary: #CFFAFE;
            --text-primary: #0F172A;
            --text-secondary: #475569;
            --card-bg: rgba(255, 255, 255, 0.95);
        }

        body {
            font-family: 'Inter', 'Helvetica Neue', sans-serif;
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
            color: var(--text-primary);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .app-container {
            width: 100%;
            max-width: 480px;
            background: var(--card-bg);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
        }

        .language-switcher {
            position: fixed;
            top: 10px;
            right: 10px;
            z-index: 1000;
            display: flex;
            gap: 8px;
        }

        .lang-btn {
            padding: 8px 12px;
            border: 2px solid var(--primary);
            background: var(--primary);
            color: white;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: 0.3s ease;
        }

        .lang-btn:hover {
            background: var(--secondary);
            border-color: var(--secondary);
        }

        .lang-btn.active {
            background: var(--primary);
            box-shadow: 0 0 0 2px white, 0 0 0 4px var(--primary);
        }

        .screen {
            display: none;
            padding: 40px 20px;
            min-height: 100vh;
            animation: fadeIn 0.4s ease-in-out;
        }

        .screen.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .welcome-screen {
            background: linear-gradient(135deg, #E0F2FE 0%, #CFFAFE 100%);
            text-align: center;
            padding: 60px 30px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            gap: 30px;
        }

        .welcome-logo {
            font-size: 80px;
            margin-bottom: 20px;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

        .welcome-title {
            font-size: 28px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 10px;
        }

        .welcome-subtitle {
            color: #FFFFFF;
            font-weight: 700;
            font-size: 18px;
            text-shadow: 0 2px 8px rgba(0,0,0,0.3);
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .welcome-description {
            font-size: 16px;
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: 30px;
        }

        .btn {
            padding: 14px 24px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: 0.3s ease;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            width: 100%;
        }

        .btn-primary:hover {
            filter: brightness(1.1);
        }

        .btn-primary:active {
            filter: brightness(0.95);
        }

        .card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 12px;
            border: 1px solid rgba(14, 165, 233, 0.1);
        }

        .card-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .input-group {
            margin-bottom: 12px;
        }

        .input-group label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            color: var(--text-secondary);
            margin-bottom: 6px;
        }

        input[type="number"],
        input[type="text"],
        input[type="range"],
        select {
            width: 100%;
            padding: 12px;
            border: 1px solid #E2E8F0;
            border-radius: 8px;
            font-size: 14px;
            font-family: inherit;
            transition: 0.3s ease;
        }

        input[type="number"]:focus,
        select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(14, 165, 233, 0.1);
        }

        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .radio-option {
            display: flex;
            align-items: center;
            padding: 10px;
            border: 1px solid #E2E8F0;
            border-radius: 8px;
            cursor: pointer;
            transition: 0.2s ease;
        }

        .radio-option:hover {
            background: rgba(14, 165, 233, 0.05);
            border-color: var(--primary);
        }

        .radio-option input[type="radio"] {
            margin-right: 10px;
            cursor: pointer;
        }

        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .checkbox-option {
            display: flex;
            align-items: center;
            padding: 10px;
            border: 1px solid #E2E8F0;
            border-radius: 8px;
            cursor: pointer;
            transition: 0.2s ease;
        }

        .checkbox-option:hover {
            background: rgba(14, 165, 233, 0.05);
        }

        .checkbox-option input[type="checkbox"] {
            margin-right: 10px;
            cursor: pointer;
            width: 18px;
            height: 18px;
        }

        .result-block {
            background: linear-gradient(135deg, rgba(14, 165, 233, 0.1), rgba(20, 184, 166, 0.1));
            border-left: 4px solid var(--primary);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 16px;
        }

        .result-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 12px;
        }

        .result-model {
            font-size: 20px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 6px;
        }

        .result-details {
            font-size: 14px;
            color: var(--text-secondary);
            line-height: 1.6;
        }

        .result-details p {
            margin-bottom: 6px;
        }

        .recommendation-text {
            background: rgba(16, 185, 129, 0.1);
            border-left: 4px solid var(--success);
            padding: 16px;
            border-radius: 8px;
            font-size: 14px;
            color: var(--text-secondary);
            margin-top: 12px;
        }

        .tips-block {
            background: rgba(245, 158, 11, 0.1);
            border-left: 4px solid var(--warning);
            padding: 16px;
            border-radius: 8px;
            margin-top: 16px;
        }

        .tips-title {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .tips-list {
            font-size: 13px;
            color: var(--text-secondary);
            line-height: 1.8;
        }

        .tips-list li {
            margin-bottom: 6px;
            margin-left: 20px;
        }

        .accordion {
            margin-top: 16px;
        }

        .accordion-button {
            width: 100%;
            padding: 12px;
            background: rgba(14, 165, 233, 0.1);
            border: 1px solid rgba(14, 165, 233, 0.2);
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            color: var(--primary);
            transition: 0.3s ease;
        }

        .accordion-button:hover {
            background: rgba(14, 165, 233, 0.15);
        }

        .accordion-content {
            display: none;
            padding: 12px;
            background: rgba(14, 165, 233, 0.05);
            border-left: 2px solid var(--primary);
            margin-top: 8px;
            border-radius: 4px;
            font-size: 13px;
            color: var(--text-secondary);
            line-height: 1.6;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .accordion-content.active {
            display: block;
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .button-group button {
            flex: 1;
        }

        .btn-secondary {
            background: rgba(14, 165, 233, 0.1);
            color: var(--primary);
            border: 1px solid var(--primary);
        }

        .btn-secondary:hover {
            background: rgba(14, 165, 233, 0.2);
        }

        @media (max-width: 480px) {
            .app-container {
                border-radius: 0;
                min-height: 100vh;
            }

            .welcome-screen {
                padding: 40px 20px;
            }

            .welcome-logo {
                font-size: 60px;
            }

            .welcome-title {
                font-size: 24px;
            }
        }
    </style>
</head>
<body>
    <div class="language-switcher">
        <button class="lang-btn active" onclick="switchLanguage('ru')">üá∑üá∫ –†–£</button>
        <button class="lang-btn" onclick="switchLanguage('en')">üá¨üáß EN</button>
    </div>

    <div class="app-container">
        <div class="screen active welcome-screen" id="welcome">
            <div class="welcome-logo">‚ùÑÔ∏è</div>
            <div class="welcome-title" id="welcomeTitle">üåä AirCalc</div>
            <div class="welcome-subtitle" id="welcomeSubtitle">–†–∞—Å—á–µ—Ç –º–æ—â–Ω–æ—Å—Ç–∏ –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä–∞</div>
            <div class="welcome-description" id="welcomeDesc">–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –ø–æ–º–æ–∂–µ—Ç –≤–∞–º –≤—ã–±—Ä–∞—Ç—å –∏–¥–µ–∞–ª—å–Ω—É—é –º–æ–¥–µ–ª—å –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä–∞ –¥–ª—è –≤–∞—à–µ–≥–æ –ø–æ–º–µ—â–µ–Ω–∏—è</div>
            <button class="btn btn-primary" onclick="switchScreen('calculator')" id="welcomeBtn">–ù–∞—á–∞—Ç—å —Ä–∞—Å—á–µ—Ç</button>
        </div>

        <div class="screen" id="calculator">
            <h1 style="font-size: 24px; margin-bottom: 20px; text-align: center;" id="calcTitle">üìã –†–∞—Å—á–µ—Ç –º–æ—â–Ω–æ—Å—Ç–∏</h1>

            <div class="card">
                <div class="card-title" id="roomParamsLabel">üìê –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–º–µ—â–µ–Ω–∏—è</div>
                <div class="input-group">
                    <label id="areaLabel">–ü–ª–æ—â–∞–¥—å –ø–æ–º–µ—â–µ–Ω–∏—è (–º¬≤)</label>
                    <input type="number" id="area" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä: 26" min="1" max="500" value="26">
                </div>
                <div class="input-group">
                    <label id="heightLabel">–í—ã—Å–æ—Ç–∞ –ø–æ—Ç–æ–ª–∫–∞ (–º)</label>
                    <input type="number" id="height" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä: 2.7" min="1" max="10" step="0.1" value="2.75">
                </div>
                <div class="input-group">
                    <label id="sunlightLabel">‚òÄÔ∏è –û—Å–≤–µ—â–µ–Ω–Ω–æ—Å—Ç—å</label>
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="sunlight" value="30" checked>
                            <span id="sunOpt1">–ó–∞—Ç–µ–Ω–µ–Ω–Ω–æ–µ (–æ–∫–Ω–∞ –Ω–∞ —Å–µ–≤–µ—Ä)</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="sunlight" value="35">
                            <span id="sunOpt2">–°—Ä–µ–¥–Ω–µ–µ (–æ–∫–Ω–∞ –Ω–∞ –≤–æ—Å—Ç–æ–∫/–∑–∞–ø–∞–¥)</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="sunlight" value="40">
                            <span id="sunOpt3">–Ø—Ä–∫–æ–µ (–æ–∫–Ω–∞ –Ω–∞ —é–≥)</span>
                        </label>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-title" id="peopleLabel">üë• –õ—é–¥–∏ –≤ –ø–æ–º–µ—â–µ–Ω–∏–∏</div>
                <div class="input-group">
                    <label><span id="peopleCountLabel">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª—é–¥–µ–π:</span> <span id="peopleCount">2</span></label>
                    <input type="range" id="people" min="0" max="20" value="2" style="width: 100%; cursor: pointer;">
                </div>
                <div class="input-group">
                    <label id="activityLabel">üö∂ –£—Ä–æ–≤–µ–Ω—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</label>
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="activity" value="0.1">
                            <span id="actOpt1">üò¥ –ù–∏–∑–∫–∞—è (–æ—Ç–¥—ã—Ö) - 0.1 –∫–í—Ç</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="activity" value="0.13" checked>
                            <span id="actOpt2">üö∂ –°—Ä–µ–¥–Ω—è—è (–¥–æ–º) - 0.13 –∫–í—Ç</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="activity" value="0.15">
                            <span id="actOpt3">üíº –í—ã—Å–æ–∫–∞—è (–æ—Ñ–∏—Å) - 0.15 –∫–í—Ç</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="activity" value="0.2">
                            <span id="actOpt4">üèÉ –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è (—Å–ø–æ—Ä—Ç) - 0.2 –∫–í—Ç</span>
                        </label>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-title" id="devicesLabel">üîß –ë—ã—Ç–æ–≤–∞—è —Ç–µ—Ö–Ω–∏–∫–∞</div>
                <div class="checkbox-group">
                    <label class="checkbox-option">
                        <input type="checkbox" class="device" data-power="0.3">
                        <span id="devComp">üíª –ö–æ–º–ø—å—é—Ç–µ—Ä (+0.3 –∫–í—Ç)</span>
                    </label>
                    <label class="checkbox-option">
                        <input type="checkbox" class="device" data-power="0.2">
                        <span id="devTV">üì∫ –¢–µ–ª–µ–≤–∏–∑–æ—Ä (+0.2 –∫–í—Ç)</span>
                    </label>
                    <label class="checkbox-option">
                        <input type="checkbox" class="device" data-power="0.05">
                        <span id="devFridge">‚ùÑÔ∏è –•–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫ (+0.05 –∫–í—Ç)</span>
                    </label>
                </div>
                <div class="input-group" style="margin-top: 12px;">
                    <label id="otherPowerLabel">–î—Ä—É–≥–∞—è —Ç–µ—Ö–Ω–∏–∫–∞ (–í—Ç)</label>
                    <input type="number" id="otherPower" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä: 100" min="0" value="0">
                </div>
            </div>

            <div class="card">
                <div class="card-title" id="factorsLabel">‚ûï –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã</div>
                <div class="checkbox-group">
                    <label class="checkbox-option">
                        <input type="checkbox" class="factor" data-factor="top_floor" data-multiplier="0.15">
                        <span id="factFloor">üè¢ –í–µ—Ä—Ö–Ω–∏–π —ç—Ç–∞–∂ (+15%)</span>
                    </label>
                    <label class="checkbox-option">
                        <input type="checkbox" class="factor" data-factor="corner" data-multiplier="0.10">
                        <span id="factCorner">üìê –£–≥–ª–æ–≤–∞—è –∫–æ–º–Ω–∞—Ç–∞ (+10%)</span>
                    </label>
                    <label class="checkbox-option">
                        <input type="checkbox" class="factor" data-factor="kitchen" data-multiplier="0.20">
                        <span id="factKitchen">üç≥ –ö—É—Ö–Ω—è (+20%)</span>
                    </label>
                    <label class="checkbox-option">
                        <input type="checkbox" class="factor" data-factor="windows" data-multiplier="0.15">
                        <span id="factWindows">ü™ü –ë–æ–ª—å—à–æ–µ –æ—Å—Ç–µ–∫–ª–µ–Ω–∏–µ (+15%)</span>
                    </label>
                </div>
            </div>

            <button class="btn btn-primary" onclick="calculate()" style="margin-top: 20px;" id="calcBtn">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å</button>
        </div>

        <div class="screen" id="results">
            <h1 style="font-size: 24px; margin-bottom: 20px; text-align: center;" id="resultsTitle">üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—Å—á–µ—Ç–∞</h1>

            <div class="result-block">
                <div class="result-title" id="recModelLabel">‚úÖ –†–ï–ö–û–ú–ï–ù–î–£–ï–ú–ê–Ø –ú–û–î–ï–õ–¨</div>
                <div class="result-model" id="modelName">–ú–æ–¥–µ–ª—å 24</div>
                <div class="result-details" id="modelDetails">
                    <p><strong id="btuLabel">BTU:</strong> <span id="modelBTU">24000</span></p>
                    <p><strong id="powerLabel">–ú–æ—â–Ω–æ—Å—Ç—å:</strong> <span id="modelPower">7.0</span> <span id="kwUnit">–∫–í—Ç</span></p>
                    <p><strong id="areaRangeLabel">–î–ª—è –ø–ª–æ—â–∞–¥–µ–π:</strong> –¥–æ <span id="modelArea">70</span> –º¬≤</p>
                </div>

                <div class="result-details" style="margin-top: 12px; border-top: 1px solid rgba(0,0,0,0.1); padding-top: 12px;">
                    <p id="yourCalcLabelContainer"><strong id="yourCalcLabel">üìä –í–∞—à —Ä–∞—Å—á–µ—Ç:</strong></p>
                    <p id="reqPowerLabelContainer"><span id="reqPowerLabelText">–¢—Ä–µ–±—É–µ–º–∞—è –º–æ—â–Ω–æ—Å—Ç—å:</span> <strong><span id="resultQ">6.82</span> <span id="kwUnit2">–∫–í—Ç</span></strong></p>
                    <p id="recRangeLabelContainer"><span id="recRangeLabelText">–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω:</span> <strong><span id="resultRange">6.48 - 7.84</span> <span id="kwUnit3">–∫–í—Ç</span></strong></p>
                </div>

                <div class="recommendation-text" id="recText">
                    ‚úì –≠—Ç–∞ –º–æ–¥–µ–ª—å –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –í–∞—à–∏—Ö —É—Å–ª–æ–≤–∏–π. –î–ª—è —Ç–æ—á–Ω–æ–≥–æ —Ä–∞—Å—á–µ—Ç–∞ –º–æ—â–Ω–æ—Å—Ç–∏, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞–º.
                </div>
            </div>

            <div id="largeRoomBlock" style="display: none;">
                <div class="result-block">
                    <div class="result-title" id="largeRoomLabel">‚ö†Ô∏è –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø –î–õ–Ø –ë–û–õ–¨–®–û–ì–û –ü–û–ú–ï–©–ï–ù–ò–Ø</div>
                    <div class="result-details" id="largeRoomDetails">
                        <p id="largeRoomText"></p>
                        <p style="margin-top: 12px; font-weight: 600;"><span id="recPowerLabel2">–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –º–æ—â–Ω–æ—Å—Ç—å:</span></p>
                        <p style="margin-top: 6px;"><span id="semiPower">14</span> <span id="kwUnit4">–∫–í—Ç</span></p>
                        <p style="margin-top: 12px; font-size: 14px; line-height: 1.6; color: #c00;" id="semiIndText">‚ö†Ô∏è –ë—ã—Ç–æ–≤—ã—Ö –Ω–∞—Å—Ç–µ–Ω–Ω—ã—Ö –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä–æ–≤ —Ç–∞–∫–æ–π –º–æ—â–Ω–æ—Å—Ç–∏ –Ω–µ –±—ã–≤–∞–µ—Ç.</p>
                        <p style="margin-top: 8px; font-size: 14px; line-height: 1.6;" id="semiIndRec">–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ–ª—É–ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã–µ –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –º–æ—â–Ω–æ—Å—Ç–∏: –∫–∞–Ω–∞–ª—å–Ω—ã–µ, –∫–∞—Å—Å–µ—Ç–Ω—ã–µ, –∫–æ–ª–æ–Ω–Ω—ã–µ –∏–ª–∏ –Ω–∞–ø–æ–ª—å–Ω–æ-–ø–æ—Ç–æ–ª–æ—á–Ω—ã–µ —Ç–∏–ø—ã.</p>
                    </div>
                </div>
            </div>

            <div class="accordion">
                <button class="accordion-button" onclick="toggleAccordion()" id="calcDetailsBtn">‚ñº –ö–∞–∫ –º—ã —Ä–∞—Å—Å—á–∏—Ç–∞–ª–∏?</button>
                <div class="accordion-content" id="calcDetails" data-lang="ru"></div>
            </div>

            <div class="tips-block">
                <div class="tips-title" id="tipsLabel">üí° –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –≠–ö–°–ü–ï–†–¢–û–í:</div>
                <ul class="tips-list">
                    <li id="tip1">–í–Ω–µ–≥–ª–∞—Å–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ: –≤ —Å—Ä–µ–¥–Ω–µ–º 1 –∫–í—Ç –Ω–∞ 10 –º¬≤ –ø–ª–æ—â–∞–¥–∏</li>
                    <li id="tip2">–ó–∞–ø–∞—Å –º–æ—â–Ω–æ—Å—Ç–∏ 10-15% –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É–µ—Ç —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—É—é –∂–∞—Ä—É</li>
                    <li id="tip3">–î–ª—è –∫—É—Ö–Ω–∏ –≤—ã–±–∏—Ä–∞–π—Ç–µ –Ω–∞ 20-30% –º–æ—â–Ω–µ–µ –æ–±—ã—á–Ω–æ–≥–æ</li>
                    <li id="tip4">–í–µ—Ä—Ö–Ω–∏–π —ç—Ç–∞–∂ –∏ —É–≥–ª–æ–≤—ã–µ –∫–æ–º–Ω–∞—Ç—ã —Ç—Ä–µ–±—É—é—Ç –±–æ–ª—å—à–µ –º–æ—â–Ω–æ—Å—Ç–∏</li>
                    <li id="tip5">–ë–æ–ª—å—à–æ–µ –æ—Å—Ç–µ–∫–ª–µ–Ω–∏–µ –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∑–∞–ø–∞—Å–∞</li>
                </ul>
            </div>

            <div class="button-group">
                <button class="btn btn-secondary" onclick="switchScreen('calculator')" id="newCalcBtn">–ù–æ–≤—ã–π —Ä–∞—Å—á–µ—Ç</button>
                <button class="btn btn-primary" onclick="shareResult()" id="shareBtn">–ü–æ–¥–µ–ª–∏—Ç—å—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º</button>
            </div>
        </div>
    </div>

    <script>
        const translations = {
            ru: {
                yourCalcLabel: 'üìä –í–∞—à —Ä–∞—Å—á–µ—Ç:',
                reqPowerLabelText: '–¢—Ä–µ–±—É–µ–º–∞—è –º–æ—â–Ω–æ—Å—Ç—å:',
                recRangeLabelText: '–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω:',
                modelLabelSmall: '–ú–æ–¥–µ–ª—å',
                modelLabelLarge: '–ú–æ—â–Ω–æ—Å—Ç—å ‚â•',
                welcomeTitle: 'üåä AirCalc',
                welcomeSubtitle: '–†–∞—Å—á–µ—Ç –º–æ—â–Ω–æ—Å—Ç–∏ –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä–∞',
                welcomeDesc: '–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –ø–æ–º–æ–∂–µ—Ç –≤–∞–º –≤—ã–±—Ä–∞—Ç—å –∏–¥–µ–∞–ª—å–Ω—É—é –º–æ–¥–µ–ª—å –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä–∞ –¥–ª—è –≤–∞—à–µ–≥–æ –ø–æ–º–µ—â–µ–Ω–∏—è',
                welcomeBtn: '–ù–∞—á–∞—Ç—å —Ä–∞—Å—á–µ—Ç',
                calcTitle: 'üìã –†–∞—Å—á–µ—Ç –º–æ—â–Ω–æ—Å—Ç–∏',
                roomParams: 'üìê –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–º–µ—â–µ–Ω–∏—è',
                areaLabel: '–ü–ª–æ—â–∞–¥—å –ø–æ–º–µ—â–µ–Ω–∏—è (–º¬≤)',
                areaPlaceholder: '–Ω–∞–ø—Ä–∏–º–µ—Ä: 26',
                heightLabel: '–í—ã—Å–æ—Ç–∞ –ø–æ—Ç–æ–ª–∫–∞ (–º)',
                heightPlaceholder: '–Ω–∞–ø—Ä–∏–º–µ—Ä: 2.7',
                sunlightLabel: '‚òÄÔ∏è –û—Å–≤–µ—â–µ–Ω–Ω–æ—Å—Ç—å',
                sunOpt1: '–ó–∞—Ç–µ–Ω–µ–Ω–Ω–æ–µ (–æ–∫–Ω–∞ –Ω–∞ —Å–µ–≤–µ—Ä)',
                sunOpt2: '–°—Ä–µ–¥–Ω–µ–µ (–æ–∫–Ω–∞ –Ω–∞ –≤–æ—Å—Ç–æ–∫/–∑–∞–ø–∞–¥)',
                sunOpt3: '–Ø—Ä–∫–æ–µ (–æ–∫–Ω–∞ –Ω–∞ —é–≥)',
                peopleLabel: 'üë• –õ—é–¥–∏ –≤ –ø–æ–º–µ—â–µ–Ω–∏–∏',
                peopleCountLabel: '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª—é–¥–µ–π:',
                activityLabel: 'üö∂ –£—Ä–æ–≤–µ–Ω—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏',
                actOpt1: 'üò¥ –ù–∏–∑–∫–∞—è (–æ—Ç–¥—ã—Ö) - 0.1 –∫–í—Ç',
                actOpt2: 'üö∂ –°—Ä–µ–¥–Ω—è—è (–¥–æ–º) - 0.13 –∫–í—Ç',
                actOpt3: 'üíº –í—ã—Å–æ–∫–∞—è (–æ—Ñ–∏—Å) - 0.15 –∫–í—Ç',
                actOpt4: 'üèÉ –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è (—Å–ø–æ—Ä—Ç) - 0.2 –∫–í—Ç',
                devicesLabel: 'üîß –ë—ã—Ç–æ–≤–∞—è —Ç–µ—Ö–Ω–∏–∫–∞',
                devComp: 'üíª –ö–æ–º–ø—å—é—Ç–µ—Ä (+0.3 –∫–í—Ç)',
                devTV: 'üì∫ –¢–µ–ª–µ–≤–∏–∑–æ—Ä (+0.2 –∫–í—Ç)',
                devFridge: '‚ùÑÔ∏è –•–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫ (+0.05 –∫–í—Ç)',
                otherPowerLabel: '–î—Ä—É–≥–∞—è —Ç–µ—Ö–Ω–∏–∫–∞ (–í—Ç)',
                otherPowerPlaceholder: '–Ω–∞–ø—Ä–∏–º–µ—Ä: 100',
                factorsLabel: '‚ûï –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã',
                factFloor: 'üè¢ –í–µ—Ä—Ö–Ω–∏–π —ç—Ç–∞–∂ (+15%)',
                factCorner: 'üìê –£–≥–ª–æ–≤–∞—è –∫–æ–º–Ω–∞—Ç–∞ (+10%)',
                factKitchen: 'üç≥ –ö—É—Ö–Ω—è (+20%)',
                factWindows: 'ü™ü –ë–æ–ª—å—à–æ–µ –æ—Å—Ç–µ–∫–ª–µ–Ω–∏–µ (+15%)',
                calcBtn: '–†–∞—Å—Å—á–∏—Ç–∞—Ç—å',
                resultsTitle: 'üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—Å—á–µ—Ç–∞',
                recModelLabel: '‚úÖ –†–ï–ö–û–ú–ï–ù–î–£–ï–ú–ê–Ø –ú–û–î–ï–õ–¨',
                btuLabel: 'BTU:',
                powerLabel: '–ú–æ—â–Ω–æ—Å—Ç—å:',
                kwUnit: '–∫–í—Ç',
                areaRangeLabel: '–î–ª—è –ø–ª–æ—â–∞–¥–µ–π:',
                yourCalcLabel: 'üìä –í–∞—à —Ä–∞—Å—á–µ—Ç:',
                reqPowerLabel: '–¢—Ä–µ–±—É–µ–º–∞—è –º–æ—â–Ω–æ—Å—Ç—å:',
                recRangeLabel: '–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω:',
                recText: '‚úì –≠—Ç–∞ –º–æ–¥–µ–ª—å –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –í–∞—à–∏—Ö —É—Å–ª–æ–≤–∏–π. –î–ª—è —Ç–æ—á–Ω–æ–≥–æ —Ä–∞—Å—á–µ—Ç–∞ –º–æ—â–Ω–æ—Å—Ç–∏, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞–º.',
                largeRoomLabel: '‚ö†Ô∏è –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø –î–õ–Ø –ë–û–õ–¨–®–û–ì–û –ü–û–ú–ï–©–ï–ù–ò–Ø',
                recPowerLabel2: '–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –º–æ—â–Ω–æ—Å—Ç—å:',
                largeRoomForAreaText: '–î–ª—è –ø–æ–º–µ—â–µ–Ω–∏—è –ø–ª–æ—â–∞–¥—å—é',
                largeRoomRequiresPowerText: '—Ç—Ä–µ–±—É–µ—Ç—Å—è –º–æ—â–Ω–æ—Å—Ç—å',
                semiIndText: '‚ö†Ô∏è –ë—ã—Ç–æ–≤—ã—Ö –Ω–∞—Å—Ç–µ–Ω–Ω—ã—Ö –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä–æ–≤ —Ç–∞–∫–æ–π –º–æ—â–Ω–æ—Å—Ç–∏ –Ω–µ –±—ã–≤–∞–µ—Ç.',
                semiIndRec: '–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ–ª—É–ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã–µ –∫–æ–Ω–¥–∏—Ü–∏–æ–Ω–µ—Ä—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –º–æ—â–Ω–æ—Å—Ç–∏: –∫–∞–Ω–∞–ª—å–Ω—ã–µ, –∫–∞—Å—Å–µ—Ç–Ω—ã–µ, –∫–æ–ª–æ–Ω–Ω—ã–µ –∏–ª–∏ –Ω–∞–ø–æ–ª—å–Ω–æ-–ø–æ—Ç–æ–ª–æ—á–Ω—ã–µ —Ç–∏–ø—ã.',
                calcDetailsBtn: '‚ñº –ö–∞–∫ –º—ã —Ä–∞—Å—Å—á–∏—Ç–∞–ª–∏?',
                tipsLabel: 'üí° –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –≠–ö–°–ü–ï–†–¢–û–í:',
                modelText: '–ú–æ–¥–µ–ª—å',
                powerText: '–ú–æ—â–Ω–æ—Å—Ç—å ‚â•',
                tip1: '–í–Ω–µ–≥–ª–∞—Å–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ: –≤ —Å—Ä–µ–¥–Ω–µ–º 1 –∫–í—Ç –Ω–∞ 10 –º¬≤ –ø–ª–æ—â–∞–¥–∏',
                tip2: '–ó–∞–ø–∞—Å –º–æ—â–Ω–æ—Å—Ç–∏ 10-15% –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É–µ—Ç —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—É—é –∂–∞—Ä—É',
                tip3: '–î–ª—è –∫—É—Ö–Ω–∏ –≤—ã–±–∏—Ä–∞–π—Ç–µ –Ω–∞ 20-30% –º–æ—â–Ω–µ–µ –æ–±—ã—á–Ω–æ–≥–æ',
                tip4: '–í–µ—Ä—Ö–Ω–∏–π —ç—Ç–∞–∂ –∏ —É–≥–ª–æ–≤—ã–µ –∫–æ–º–Ω–∞—Ç—ã —Ç—Ä–µ–±—É—é—Ç –±–æ–ª—å—à–µ –º–æ—â–Ω–æ—Å—Ç–∏',
                tip5: '–ë–æ–ª—å—à–æ–µ –æ—Å—Ç–µ–∫–ª–µ–Ω–∏–µ –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∑–∞–ø–∞—Å–∞',
                newCalcBtn: '–ù–æ–≤—ã–π —Ä–∞—Å—á–µ—Ç',
                shareBtn: '–ü–æ–¥–µ–ª–∏—Ç—å—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º',
            },
            en: {
                yourCalcLabel: 'üìä Your Calculation:',
                reqPowerLabelText: 'Required Power:',
                recRangeLabelText: 'Recommended Range:',
                modelLabelSmall: 'Model',
                modelLabelLarge: 'Power ‚â•',
                welcomeTitle: 'üåä AirCalc',
                welcomeSubtitle: 'Air Conditioner Power Calculator',
                welcomeDesc: 'A professional calculator to help you choose the ideal air conditioner model for your premises',
                welcomeBtn: 'Start Calculation',
                calcTitle: 'üìã Power Calculation',
                roomParams: 'üìê Room Parameters',
                areaLabel: 'Room Area (m¬≤)',
                areaPlaceholder: 'for example: 26',
                heightLabel: 'Ceiling Height (m)',
                heightPlaceholder: 'for example: 2.7',
                sunlightLabel: '‚òÄÔ∏è Illumination',
                sunOpt1: 'Shaded (windows facing north)',
                sunOpt2: 'Medium (windows facing east/west)',
                sunOpt3: 'Bright (windows facing south)',
                peopleLabel: 'üë• People in Room',
                peopleCountLabel: 'Number of people:',
                activityLabel: 'üö∂ Activity Level',
                actOpt1: 'üò¥ Low (rest) - 0.1 kW',
                actOpt2: 'üö∂ Medium (home) - 0.13 kW',
                actOpt3: 'üíº High (office) - 0.15 kW',
                actOpt4: 'üèÉ Very high (sports) - 0.2 kW',
                devicesLabel: 'üîß Household Appliances',
                devComp: 'üíª Computer (+0.3 kW)',
                devTV: 'üì∫ Television (+0.2 kW)',
                devFridge: '‚ùÑÔ∏è Refrigerator (+0.05 kW)',
                otherPowerLabel: 'Other appliances (W)',
                otherPowerPlaceholder: 'for example: 100',
                factorsLabel: '‚ûï Additional Factors',
                factFloor: 'üè¢ Top Floor (+15%)',
                factCorner: 'üìê Corner Room (+10%)',
                factKitchen: 'üç≥ Kitchen (+20%)',
                factWindows: 'ü™ü Large Windows (+15%)',
                calcBtn: 'Calculate',
                resultsTitle: 'üìä Calculation Results',
                recModelLabel: '‚úÖ RECOMMENDED MODEL',
                btuLabel: 'BTU:',
                powerLabel: 'Power:',
                kwUnit: 'kW',
                areaRangeLabel: 'For areas:',
                yourCalcLabel: 'üìä Your Calculation:',
                reqPowerLabel: 'Required Power:',
                recRangeLabel: 'Recommended Range:',
                largeRoomLabel: '‚ö†Ô∏è RECOMMENDATION FOR LARGE PREMISES',
                recPowerLabel2: 'Recommended Power:',
                largeRoomForAreaText: 'For a room with an area of',
                largeRoomRequiresPowerText: 'required power',
                semiIndText: '‚ö†Ô∏è Such power capacity wall-mounted air conditioners do not exist.',
                semiIndRec: 'We recommend considering semi-industrial air conditioners of appropriate power: channel, cassette, column, or floor-ceiling types.',
                calcDetailsBtn: '‚ñº How did we calculate?',
                tipsLabel: 'üí° EXPERT RECOMMENDATIONS:',
                modelText: 'Model',
                powerText: 'Power ‚â•',
                tip1: 'General rule: approximately 1 kW per 10 m¬≤ of area',
                tip2: 'Power margin of 10-15% compensates for extreme heat',
                tip3: 'For kitchens, choose 20-30% more powerful than usual',
                tip4: 'Top floors and corner rooms require more power',
                tip5: 'Large windows may require additional power margin',
                newCalcBtn: 'New Calculation',
                shareBtn: 'Share Result',
                recText: '‚úì This model is suitable for your conditions. For accurate power calculation, please consult with specialists.',
            }
        };

        function switchLanguage(lang) {
            localStorage.setItem('language', lang);
            updateLanguage(lang);
        }

        function updateLanguage(lang) {
            const t = translations[lang];
            const setText = (id, text) => {
                const el = document.getElementById(id);
                if (el && text) el.textContent = text;
            };
            const setPlaceholder = (id, text) => {
                const el = document.getElementById(id);
                if (el && text) el.placeholder = text;
            };
            
            setText('powerLabel', t.powerLabel);
            setText('welcomeTitle', t.welcomeTitle);
            setText('welcomeSubtitle', t.welcomeSubtitle);
            setText('welcomeDesc', t.welcomeDesc);
            setText('welcomeBtn', t.welcomeBtn);
            setText('calcTitle', t.calcTitle);
            setText('roomParamsLabel', t.roomParams);
            setText('areaLabel', t.areaLabel);
            setPlaceholder('area', t.areaPlaceholder);
            setText('heightLabel', t.heightLabel);
            setPlaceholder('height', t.heightPlaceholder);
            setText('sunlightLabel', t.sunlightLabel);
            setText('sunOpt1', t.sunOpt1);
            setText('sunOpt2', t.sunOpt2);
            setText('sunOpt3', t.sunOpt3);
            setText('peopleLabel', t.peopleLabel);
            setText('peopleCountLabel', t.peopleCountLabel);
            setText('activityLabel', t.activityLabel);
            setText('actOpt1', t.actOpt1);
            setText('actOpt2', t.actOpt2);
            setText('actOpt3', t.actOpt3);
            setText('actOpt4', t.actOpt4);
            setText('devicesLabel', t.devicesLabel);
            setText('devComp', t.devComp);
            setText('devTV', t.devTV);
            setText('devFridge', t.devFridge);
            setText('otherPowerLabel', t.otherPowerLabel);
            setPlaceholder('otherPower', t.otherPowerPlaceholder);
            setText('factorsLabel', t.factorsLabel);
            setText('factFloor', t.factFloor);
            setText('factCorner', t.factCorner);
            setText('factKitchen', t.factKitchen);
            setText('factWindows', t.factWindows);
            setText('calcBtn', t.calcBtn);
            setText('resultsTitle', t.resultsTitle);
            setText('recModelLabel', t.recModelLabel);
            setText('btuLabel', t.btuLabel);
            document.querySelectorAll('#kwUnit, #kwUnit2, #kwUnit3, #kwUnit4').forEach(el => {
                if (el && t.kwUnit) el.textContent = t.kwUnit;
            });
            setText('areaRangeLabel', t.areaRangeLabel);
            setText('yourCalcLabel', t.yourCalcLabel);
            setText('reqPowerLabelText', t.reqPowerLabelText);
            setText('recRangeLabelText', t.recRangeLabelText);
            setText('recText', t.recText);
            setText('largeRoomLabel', t.largeRoomLabel);
            setText('recPowerLabel2', t.recPowerLabel2);
            setText('modelText', t.modelText);
            setText('powerText', t.powerText);
            setText('semiIndText', t.semiIndText);
            setText('semiIndRec', t.semiIndRec);
            setText('calcDetailsBtn', t.calcDetailsBtn);
            setText('tipsLabel', t.tipsLabel);
            setText('tip1', t.tip1);
            setText('tip2', t.tip2);
            setText('tip3', t.tip3);
            setText('tip4', t.tip4);
            setText('tip5', t.tip5);
            setText('newCalcBtn', t.newCalcBtn);
            setText('shareBtn', t.shareBtn);
            
            document.querySelectorAll('.lang-btn').forEach(btn => {
                if (btn) btn.classList.remove('active');
            });
            const activeLangBtn = document.querySelector(`[onclick="switchLanguage('${lang}')"]`);
            if (activeLangBtn) activeLangBtn.classList.add('active');

            updateLargeRoomText(lang);
        }

        function updateLargeRoomText(lang) {
            const largeRoomTextEl = document.getElementById('largeRoomText');
            if (largeRoomTextEl && largeRoomTextEl.getAttribute('data-area')) {
                const t = translations[lang];
                const area = largeRoomTextEl.getAttribute('data-area');
                const power = largeRoomTextEl.getAttribute('data-power');
                const forArea = t.largeRoomForAreaText || '–î–ª—è –ø–æ–º–µ—â–µ–Ω–∏—è –ø–ª–æ—â–∞–¥—å—é';
                const requiresPower = t.largeRoomRequiresPowerText || '—Ç—Ä–µ–±—É–µ—Ç—Å—è –º–æ—â–Ω–æ—Å—Ç—å';
                largeRoomTextEl.textContent = `${forArea} ${area} –º¬≤ ${requiresPower} ${power} –∫–í—Ç.`;
            }
        }

        const acModelsBytovye = [
            {marking: 20, model: 7, btu: 7000, kw: 2.1, area: 20},
            {marking: 25, model: 9, btu: 9000, kw: 2.6, area: 25},
            {marking: 35, model: 12, btu: 12000, kw: 3.5, area: 35},
            {marking: 50, model: 18, btu: 18000, kw: 5.3, area: 50},
            {marking: 71, model: 24, btu: 24000, kw: 7.0, area: 70},
            {marking: 80, model: 28, btu: 28000, kw: 8.2, area: 80},
            {marking: 100, model: 36, btu: 36000, kw: 10.6, area: 110}
        ];

        const semiIndustrialPowers = [12.3, 14.0, 16.0, 18.0, 20.0, 22.0, 24.0, 28.0, 30.0, 36.0, 40.0, 48.0];

        const tg = window.Telegram.WebApp;
        tg.expand();

        function trackEvent(eventName, params = {}) {
            console.log(`üìä –°–æ–±—ã—Ç–∏–µ: ${eventName}`, params);
            const eventData = {
                event: eventName,
                timestamp: new Date().toISOString(),
                data: params,
                userId: tg.initDataUnsafe?.user?.id || 'unknown',
                username: tg.initDataUnsafe?.user?.username || 'unknown'
            };
            fetch('/webapp', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify(eventData)
            }).catch(err => console.error('Tracking error:', err));
            if (tg && tg.sendData) {
                tg.sendData(JSON.stringify(eventData));
            }
        }

        function switchScreen(screenName) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(screenName).classList.add('active');
            trackEvent('screen_switched', { screen: screenName });
        }

        document.getElementById('people').addEventListener('input', function() {
            document.getElementById('peopleCount').textContent = this.value;
        });

        function calculate() {
            try {
                const areaEl = document.getElementById('area');
                const heightEl = document.getElementById('height');
                const sunlightEl = document.querySelector('input[name="sunlight"]:checked');
                const peopleEl = document.getElementById('people');
                const activityEl = document.querySelector('input[name="activity"]:checked');
                const otherPowerEl = document.getElementById('otherPower');

                if (!areaEl || !heightEl || !sunlightEl || !peopleEl || !activityEl || !otherPowerEl) {
                    throw new Error('Missing required form elements');
                }

                const area = parseFloat(areaEl.value);
                const height = parseFloat(heightEl.value);
                const sunlight = parseFloat(sunlightEl.value);
                const people = parseInt(peopleEl.value);
                const activity = parseFloat(activityEl.value);
                const otherPower = parseFloat(otherPowerEl.value) || 0;

                if (isNaN(area) || isNaN(height) || isNaN(sunlight) || isNaN(people) || isNaN(activity)) {
                    throw new Error('Invalid input values');
                }

                console.log('Calculation started:', { area, height, sunlight, people, activity, otherPower });
                trackEvent('calculation_started', { area, height, people });

                const Q1 = (area * height * sunlight) / 1000;
                const Q2 = people * activity;
                let Q3 = 0;
                document.querySelectorAll('.device:checked').forEach(device => {
                    Q3 += parseFloat(device.dataset.power);
                });
                Q3 += (otherPower * 0.3) / 1000;

                let Q = Q1 + Q2 + Q3;
                document.querySelectorAll('.factor:checked').forEach(factor => {
                    Q *= (1 + parseFloat(factor.dataset.multiplier));
                });

                const Q_min = Q * 0.95;
                const Q_max = Q * 1.15;

                let recommended;

                if (Q <= 10.6) {
                    recommended = acModelsBytovye[0];
                    for (let model of acModelsBytovye) {
                        if (model.kw >= Q_min) {
                            recommended = model;
                            if (model.kw >= Q) break;
                        }
                    }
                    
                    const modelNameEl = document.getElementById('modelName');
                    const modelBTUEl = document.getElementById('modelBTU');
                    const modelPowerEl = document.getElementById('modelPower');
                    const modelAreaEl = document.getElementById('modelArea');
                    const largeRoomEl = document.getElementById('largeRoomBlock');
                    
                    const lang = localStorage.getItem('language') || 'ru';
                    const t = translations[lang];
                    if (modelNameEl) modelNameEl.textContent = `${t.modelLabelSmall} ${recommended.model}`;
                    if (modelBTUEl) modelBTUEl.textContent = recommended.btu.toLocaleString();
                    if (modelPowerEl) modelPowerEl.textContent = recommended.kw.toFixed(1);
                    if (modelAreaEl) modelAreaEl.textContent = recommended.area;
                    if (largeRoomEl) largeRoomEl.style.display = 'none';
                } else {
                    let recommendedPower = semiIndustrialPowers[0];
                    for (let power of semiIndustrialPowers) {
                        if (power >= Q) {
                            recommendedPower = power;
                            break;
                        }
                    }
                    
                    const semiIndustBTU = Math.round(recommendedPower * 3400);
                    const semiIndustArea = Math.round(recommendedPower * 10);
                    
                    const modelNameEl = document.getElementById('modelName');
                    const modelBTUEl = document.getElementById('modelBTU');
                    const modelPowerEl = document.getElementById('modelPower');
                    const modelAreaEl = document.getElementById('modelArea');
                    const largeRoomEl = document.getElementById('largeRoomBlock');
                    const largeRoomTextEl = document.getElementById('largeRoomText');
                    const semiPowerEl = document.getElementById('semiPower');
                    
                    const lang2 = localStorage.getItem('language') || 'ru';
                    const t2 = translations[lang2];
                    if (modelNameEl) modelNameEl.textContent = `${t2.modelLabelLarge} ${recommendedPower} –∫–í—Ç`;
                    if (modelBTUEl) modelBTUEl.textContent = semiIndustBTU.toLocaleString();
                    if (modelPowerEl) modelPowerEl.textContent = recommendedPower.toFixed(1);
                    if (modelAreaEl) modelAreaEl.textContent = semiIndustArea;
                    if (largeRoomEl) largeRoomEl.style.display = 'block';
                    
                    if (largeRoomTextEl) {
                        const lang = localStorage.getItem('language') || 'ru';
                        const t = translations[lang];
                        const forArea = t.largeRoomForAreaText || '–î–ª—è –ø–æ–º–µ—â–µ–Ω–∏—è –ø–ª–æ—â–∞–¥—å—é';
                        const requiresPower = t.largeRoomRequiresPowerText || '—Ç—Ä–µ–±—É–µ—Ç—Å—è –º–æ—â–Ω–æ—Å—Ç—å';
                        largeRoomTextEl.textContent = `${forArea} ${area} –º¬≤ ${requiresPower} ${Q.toFixed(2)} –∫–í—Ç.`;
                        largeRoomTextEl.setAttribute('data-area', area);
                        largeRoomTextEl.setAttribute('data-power', Q.toFixed(2));
                    }
                    
                    if (semiPowerEl) semiPowerEl.textContent = recommendedPower.toFixed(1);
                }

                const resultQEl = document.getElementById('resultQ');
                const resultRangeEl = document.getElementById('resultRange');
                const calcDetailsEl = document.getElementById('calcDetails');
                
                if (resultQEl) resultQEl.textContent = Q.toFixed(2);
                if (resultRangeEl) resultRangeEl.textContent = `${Q_min.toFixed(2)} - ${Q_max.toFixed(2)}`;

                const calcDetailsRu = `Q‚ÇÅ (–ø–æ–º–µ—â–µ–Ω–∏–µ) = ${area} √ó ${height} √ó ${sunlight} / 1000 = ${Q1.toFixed(2)} –∫–í—Ç\nQ‚ÇÇ (–ª—é–¥–∏) = ${people} √ó ${activity} = ${Q2.toFixed(2)} –∫–í—Ç\nQ‚ÇÉ (—Ç–µ—Ö–Ω–∏–∫–∞) = ${Q3.toFixed(2)} –∫–í—Ç\n\nQ = ${Q.toFixed(2)} –∫–í—Ç\n\n–î–∏–∞–ø–∞–∑–æ–Ω: ${Q_min.toFixed(2)} - ${Q_max.toFixed(2)} –∫–í—Ç`;
                const calcDetailsEn = `Q‚ÇÅ (room) = ${area} √ó ${height} √ó ${sunlight} / 1000 = ${Q1.toFixed(2)} kW\nQ‚ÇÇ (people) = ${people} √ó ${activity} = ${Q2.toFixed(2)} kW\nQ‚ÇÉ (devices) = ${Q3.toFixed(2)} kW\n\nQ = ${Q.toFixed(2)} kW\n\nRange: ${Q_min.toFixed(2)} - ${Q_max.toFixed(2)} kW`;
                
                if (calcDetailsEl) {
                    calcDetailsEl.setAttribute('data-calc-ru', calcDetailsRu);
                    calcDetailsEl.setAttribute('data-calc-en', calcDetailsEn);
                    const lang = localStorage.getItem('language') || 'ru';
                    calcDetailsEl.textContent = lang === 'ru' ? calcDetailsRu : calcDetailsEn;
                }

                trackEvent('calculation_completed', { result_power_kw: Q.toFixed(2), area });

                switchScreen('results');
            } catch (error) {
                console.error('Calculate error:', error);
                alert('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ: ' + error.message);
            }
        }

        function shareResult() {
            trackEvent('result_shared', { method: 'copy_to_clipboard' });
            const lang = localStorage.getItem('language') || 'ru';
            const message = lang === 'ru' 
                ? '‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!' 
                : '‚úÖ Result copied to clipboard!';
            alert(message);
        }

        function toggleAccordion() {
            const content = document.getElementById('calcDetails');
            content.classList.toggle('active');
        }

        function updateAccordionContent(lang) {
            const calcDetailsEl = document.getElementById('calcDetails');
            if (calcDetailsEl) {
                const calcDetailsRu = calcDetailsEl.getAttribute('data-calc-ru');
                const calcDetailsEn = calcDetailsEl.getAttribute('data-calc-en');
                
                if (calcDetailsRu && calcDetailsEn) {
                    calcDetailsEl.textContent = lang === 'ru' ? calcDetailsRu : calcDetailsEn;
                }
            }
        }

        const originalSwitchLanguage = switchLanguage;
        switchLanguage = function(lang) {
            originalSwitchLanguage(lang);
            updateAccordionContent(lang);
        };

        const savedLang = localStorage.getItem('language') || 'ru';
        updateLanguage(savedLang);
        
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
            const ruBtn = document.querySelector("[onclick=\"switchLanguage('ru')\"]");
            if (ruBtn) ruBtn.classList.add('active');
        });
        tg.ready();
        trackEvent('aircalc_opened', { timestamp: new Date().toISOString() });
    </script>
</body>
</html>